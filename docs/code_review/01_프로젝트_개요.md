# 01. 프로젝트 개요

## 1.1 프로젝트 소개

이 프로젝트는 **FastAPI + Jinja2 + HTMX** 기반의 풀스택 웹 애플리케이션 보일러플레이트입니다. JavaScript 프레임워크(React, Vue 등) 없이도 동적인 SPA(Single Page Application)와 유사한 사용자 경험을 제공하는 것을 목표로 합니다.

### 핵심 기술 스택

| 계층 | 기술 | 버전 | 역할 |
|------|------|------|------|
| **백엔드** | FastAPI | 0.115+ | 비동기 웹 프레임워크 |
| **서버** | Uvicorn | 0.30+ | ASGI 서버 |
| **템플릿** | Jinja2 | 3.1+ | 서버사이드 렌더링 |
| **프론트엔드** | HTMX | 2.0+ | AJAX/동적 UI (JavaScript 최소화) |
| **상호작용** | Alpine.js | 3.x | 가벼운 반응형 JavaScript |
| **CSS** | TailwindCSS | 3.4+ | 유틸리티 기반 스타일 (CDN) |
| **ORM** | SQLAlchemy | 2.0+ | 비동기 ORM |
| **DB** | SQLite / PostgreSQL | - | 개발/프로덕션 데이터베이스 |
| **인증** | python-jose | 3.3+ | JWT 토큰 |
| **비밀번호** | bcrypt | - | 비밀번호 해싱 |
| **마이그레이션** | Alembic | 1.13+ | 데이터베이스 마이그레이션 |
| **검증** | Pydantic | 2.0+ | 데이터 검증 |

---

## 1.2 디렉토리 구조

```
FastAPI_Jinja2_HTMX_Boilerplate/
├── app/                          # 애플리케이션 핵심 코드
│   ├── __init__.py
│   ├── main.py                   # FastAPI 앱 진입점
│   ├── config.py                 # 환경 설정
│   ├── database.py               # SQLAlchemy 비동기 엔진
│   │
│   ├── api/                      # REST API 라우터 (JSON 응답)
│   │   ├── deps.py               # 의존성 주입
│   │   └── v1/
│   │       ├── auth.py           # 인증 API
│   │       ├── items.py          # 아이템 CRUD API
│   │       ├── users.py          # 사용자 관리 API
│   │       └── router.py         # API 라우터 통합
│   │
│   ├── pages/                    # HTML 페이지 라우터
│   │   ├── home.py               # 홈페이지
│   │   ├── auth.py               # 로그인/회원가입 페이지
│   │   ├── dashboard.py          # 대시보드 페이지
│   │   └── router.py             # 페이지 라우터 통합
│   │
│   ├── partials/                 # HTMX 파셜 라우터 (HTML 조각)
│   │   ├── auth.py               # 인증 파셜
│   │   ├── items.py              # 아이템 파셜
│   │   ├── modals.py             # 모달 파셜
│   │   ├── toasts.py             # 토스트 알림 파셜
│   │   └── router.py             # 파셜 라우터 통합
│   │
│   ├── models/                   # SQLAlchemy ORM 모델
│   │   ├── base.py               # 기본 모델 클래스
│   │   ├── user.py               # User 모델
│   │   └── item.py               # Item 모델
│   │
│   ├── schemas/                  # Pydantic 스키마
│   │   ├── user.py               # 사용자 스키마
│   │   ├── item.py               # 아이템 스키마
│   │   └── common.py             # 공통 스키마
│   │
│   ├── services/                 # 비즈니스 로직 레이어
│   │   ├── auth.py               # AuthService
│   │   ├── user.py               # UserService
│   │   └── item.py               # ItemService
│   │
│   └── core/                     # 핵심 유틸리티
│       ├── security.py           # JWT, 비밀번호 해싱
│       ├── exceptions.py         # 커스텀 예외 핸들러
│       └── templates.py          # Jinja2 설정
│
├── templates/                    # Jinja2 템플릿
│   ├── base.html                 # 기본 레이아웃
│   ├── pages/                    # 전체 페이지 템플릿
│   ├── components/               # 재사용 컴포넌트
│   └── partials/                 # HTMX 파셜 템플릿
│
├── static/                       # 정적 파일
│   ├── css/custom.css            # 커스텀 CSS
│   ├── js/app.js                 # 메인 JavaScript
│   └── img/                      # 이미지 파일
│
├── tests/                        # 테스트 코드
├── alembic/                      # DB 마이그레이션
└── docs/                         # 문서
```

---

## 1.3 아키텍처 개요

### 3가지 라우터 레이어

이 프로젝트는 요청 유형에 따라 3가지 라우터 레이어를 분리하여 관리합니다:

```
HTTP 요청
    │
    ├─────────────────────────────────────────┐
    │                                         │
┌───▼───────────────────┐  ┌──────────────────▼───────────────────┐
│ 1. API Router         │  │ 2. Pages Router                      │
│ /api/v1/*             │  │ /* (루트)                            │
│                       │  │                                      │
│ • REST API 엔드포인트 │  │ • 전체 HTML 페이지 반환              │
│ • JSON 응답           │  │ • base.html 상속                     │
│ • 외부 클라이언트용   │  │ • 초기 페이지 로드용                 │
└───────────────────────┘  └──────────────────────────────────────┘
                                              │
                           ┌──────────────────▼───────────────────┐
                           │ 3. Partials Router                   │
                           │ /partials/*                          │
                           │                                      │
                           │ • HTML 조각(fragment) 반환           │
                           │ • HTMX 요청 처리                     │
                           │ • 부분 업데이트용                    │
                           └──────────────────────────────────────┘
```

### 요청 처리 흐름

```
┌────────────────────────────────────────────────────────────────────┐
│                         HTTP 요청                                  │
└────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│                    Router 매칭 (FastAPI)                           │
│   /api/v1/* → API Router                                          │
│   /partials/* → Partials Router                                   │
│   /* → Pages Router                                               │
└────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│               의존성 주입 (Depends)                                 │
│   • DbSession: 비동기 DB 세션                                      │
│   • CurrentUser: 인증된 사용자                                     │
│   • get_*_service: 서비스 인스턴스                                 │
└────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│                Service Layer (비즈니스 로직)                        │
│   • AuthService: 인증/인가                                         │
│   • UserService: 사용자 관리                                       │
│   • ItemService: 아이템 CRUD                                       │
└────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│                 Model Layer (SQLAlchemy ORM)                        │
│   • User 모델                                                      │
│   • Item 모델                                                      │
│   • 데이터베이스 쿼리 실행                                         │
└────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│                 Template Rendering (Jinja2)                         │
│   • Pydantic 스키마로 데이터 검증                                  │
│   • Jinja2 템플릿에 데이터 전달                                    │
│   • HTML 또는 JSON 응답 생성                                       │
└────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌────────────────────────────────────────────────────────────────────┐
│                       Response                                      │
│   • API: JSON                                                      │
│   • Pages: Full HTML                                               │
│   • Partials: HTML Fragment                                        │
└────────────────────────────────────────────────────────────────────┘
```

---

## 1.4 핵심 설계 원칙

### 1. 관심사 분리 (Separation of Concerns)

```
┌─────────────────────────────────────────────────────────────────────┐
│                         Presentation Layer                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │
│  │   API        │  │   Pages      │  │   Partials   │              │
│  │   (JSON)     │  │   (HTML)     │  │   (HTML)     │              │
│  └──────────────┘  └──────────────┘  └──────────────┘              │
└─────────────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         Business Layer                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │
│  │ AuthService  │  │ UserService  │  │ ItemService  │              │
│  └──────────────┘  └──────────────┘  └──────────────┘              │
└─────────────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────────┐
│                          Data Layer                                 │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │
│  │    User      │  │    Item      │  │   Database   │              │
│  │    Model     │  │    Model     │  │   Session    │              │
│  └──────────────┘  └──────────────┘  └──────────────┘              │
└─────────────────────────────────────────────────────────────────────┘
```

### 2. 의존성 주입 (Dependency Injection)

FastAPI의 `Depends()` 시스템을 활용하여 테스트 가능하고 유지보수 용이한 코드 구조를 구현합니다.

### 3. 비동기 프로그래밍 (Async/Await)

모든 데이터베이스 작업과 외부 API 호출은 비동기로 처리되어 높은 동시성을 지원합니다.

### 4. 타입 안전성 (Type Safety)

Pydantic 스키마와 Python 타입 힌트를 활용하여 런타임 오류를 최소화합니다.

---

## 1.5 주요 기능

| 기능 | 설명 |
|------|------|
| **사용자 인증** | JWT 기반 로그인/로그아웃, 회원가입 |
| **권한 관리** | 일반 사용자/관리자 권한 구분 |
| **아이템 CRUD** | 생성, 조회, 수정, 삭제 기능 |
| **다크모드** | 시스템 설정 또는 수동 전환 |
| **반응형 UI** | 모바일/데스크탑 최적화 |
| **HTMX 통합** | JavaScript 없는 동적 UI |
| **토스트 알림** | 사용자 피드백 알림 |
| **모달 대화상자** | 확인/입력 폼 모달 |

---

## 1.6 기본 포트 및 실행

- **기본 포트**: `8001` (8000이 아닌 8001 사용)
- **개발 서버 실행**: `python run.py` 또는 `uvicorn app.main:app --reload --port 8001`
- **API 문서**: `http://localhost:8001/docs` (개발 모드에서만 활성화)
