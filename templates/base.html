<!DOCTYPE html>
<html lang="ko" x-data="{ darkMode: localStorage.getItem('darkMode') === 'true' }"
      :class="{ 'dark': darkMode }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{ app_name }} - FastAPI + Jinja2 + HTMX 보일러플레이트">

    <title>{% block title %}{{ title | default(app_name) }}{% endblock %} | {{ app_name }}</title>

    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    }
                }
            }
        }
    </script>

    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@2.0.0"></script>

    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/custom.css">

    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen"
      hx-boost="true">

    <!-- Toast Container -->
    <div id="toast-container"
         class="fixed top-4 right-4 z-50 flex flex-col gap-2"
         x-data="toastHandler()"
         @showToast.window="show($event.detail)">
    </div>

    <!-- Modal Container -->
    <div id="modal-container"
         x-data="{ open: false }"
         @openModal.window="open = true"
         @closeModal.window="open = false"
         @keydown.escape.window="open = false">
        <div x-show="open"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0"
             x-transition:enter-end="opacity-100"
             x-transition:leave="transition ease-in duration-150"
             x-transition:leave-start="opacity-100"
             x-transition:leave-end="opacity-0"
             class="fixed inset-0 bg-black/50 z-40"
             @click="open = false">
        </div>
        <div id="modal-content"
             x-show="open"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-150"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             class="fixed inset-0 z-50 flex items-center justify-center p-4"
             @click.self="open = false">
        </div>
    </div>

    <!-- Navigation -->
    {% include "components/navbar.html" %}

    <!-- Main Content -->
    <main class="{% block main_class %}container mx-auto px-4 py-8{% endblock %}">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    {% include "components/footer.html" %}

    <!-- Loading Indicator -->
    <div id="loading-indicator"
         class="htmx-indicator fixed top-0 left-0 right-0 h-1 bg-primary-500 z-50">
        <div class="h-full bg-primary-300 animate-pulse"></div>
    </div>

    <!-- Custom JS -->
    <script src="/static/js/app.js"></script>

    {% block extra_scripts %}{% endblock %}
</body>
</html>
